<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="See README.md.">
<title>An R package pipelining omics-based cancer survival analysis • patroklos</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="An R package pipelining omics-based cancer survival analysis">
<meta property="og:description" content="See README.md.">
<meta property="og:image" content="https://lgessl.github.io/patroklos/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">patroklos</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="patroklos-">patroklos <a class="anchor" aria-label="anchor" href="#patroklos-"></a>
</h1>
</div>
<p><!-- badges: start --></p>
<p><a href="https://github.com/lgessl/patroklos/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/lgessl/patroklos/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></p>
<p><!-- badges: end --></p>
<div class="section level2">
<h2 id="a-pipeline-to-learn-omics-based-survival-models-for-cancer-patients">A pipeline to learn omics-based survival models for cancer patients<a class="anchor" aria-label="anchor" href="#a-pipeline-to-learn-omics-based-survival-models-for-cancer-patients"></a>
</h2>
<div class="section level3">
<h3 id="whats-the-scenario-this-r-package-is-made-for">What’s the scenario this R package is made for?<a class="anchor" aria-label="anchor" href="#whats-the-scenario-this-r-package-is-made-for"></a>
</h3>
<p>Imagine you are given a data set holding information on cancer patients. This data includes a high-dimensional measurement like bulk RNA-seq data (“expression data”) and some other features (“pheno data”). Among the pheno data is survival information in the form of time to event and right censoring. You want to build a binary classifier that takes a subset of your features (excluding the two survival features) as input to predict for a given sample if it faces the event (like progression or death) before or after a certain time.</p>
<p>Finding such a classifier involves a lot of trial and error: you will try out a whole bunch of models. Every model family again involves some hyperparameters you need to tune. The high-dimensional part of your data requires you to apply regularization to your models, in other words: tuning a regularization parameter. After you’ve trained the models, you need to assess them and finally come up with the “best” one, where you first need to decide what you mean by “best”.</p>
<p>Even after you’ve picked a winner, this is just the winner on a specific data set. Somebody (maybe even yourself) may come up with another data set and you need to do an analogous analysis on the new data set.</p>
<p>patroklos will do all the repetitive, administrative work and lets you focus on the mathematical and biological part of your work.</p>
<p>All in all, patroklos is not the star of the show, but it plays a key role in it—just like Πάτροκλος in the Iliad: being Achilles’ best friend, his death brings Achilles back to the battlefield helping the Greeks score decisive victories.</p>
</div>
<div class="section level3">
<h3 id="how-does-this-r-package-make-your-life-easier">How does this R package make your life easier?<a class="anchor" aria-label="anchor" href="#how-does-this-r-package-make-your-life-easier"></a>
</h3>
<p>patroklos has three major goals: making integrating</p>
<ul>
<li>new data,</li>
<li>new models and</li>
<li>new kinds of assessments</li>
</ul>
<p>into your workflow as easy and effortless as possible without forcing you too much to use a certain paradigm.</p>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>We give you the tools to preprocess new data and bring it into the format patroklos works with. You specify and store everything in the R6 class <code>Data</code>.</p>
</div>
<div class="section level4">
<h4 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h4>
<p>You specify models in another R6 class, <code>Model</code>; “specifying” means fixing all hyperparameters except for the regularization parameter <span class="math inline"><em>λ</em></span>. Why? To tune <span class="math inline"><em>λ</em></span> we split the data into a train and test cohort and determine its optimal choice in a cross validation on the train cohort. The function optimizing <span class="math inline"><em>λ</em></span> and all the other model parameters is an attribute of the <code>Model</code> object and you can easily provide your own ones.</p>
</div>
<div class="section level4">
<h4 id="assessment">Assessment<a class="anchor" aria-label="anchor" href="#assessment"></a>
</h4>
<p>On the test cohort (which we haven’t touched so far) we can now assess the trained models. Keep in mind that most models used as binary classifiers don’t output the final classification, but only continuous score that we need to threshold (this threshold is yet another hyperparameter of the model). To find the model best fulfilling its job and threshold it, we proceed as follows:</p>
<ol style="list-style-type: decimal">
<li>In a pre-selection step, we map every trained model to a single real number: a score indicating its goodness on the test cohort (like the ROC-AUC). Of course, you can define your metric here. This allows us to reduce the models of interest to an arbitrary small number if not one. The R6 class <code>AssScalar</code> does this.</li>
<li>For the remaining models, we plot one metric against another metric (e.g. rate of positive predictions versus precision). Keep in mind: we essentially get as many points in the two-dimensional space as the model has different output values here as we can use every output value as a threshold. This plot or these plots will guide our decision for a threshold and therefore for a final binary classifier. The R6 class <code>Ass2d</code> does this.</li>
</ol>
</div>
<div class="section level4">
<h4 id="in-a-nut-shell">In a nut shell<a class="anchor" aria-label="anchor" href="#in-a-nut-shell"></a>
</h4>
<p><img src="reference/figures/README-/test-train.jpeg" alt="drawing" width="400"></p>
</div>
</div>
<div class="section level3">
<h3 id="more-tweaks-powered-by-patroklos">More tweaks powered by patroklos<a class="anchor" aria-label="anchor" href="#more-tweaks-powered-by-patroklos"></a>
</h3>
<div class="section level4">
<h4 id="repeated-splits-into-training-and-test-cohort">Repeated splits into training and test cohort<a class="anchor" aria-label="anchor" href="#repeated-splits-into-training-and-test-cohort"></a>
</h4>
<p>Splitting your data into a training and test cohort is very close to the real-world scenario, in which the entity generating the data withholds the test cohort in the first place and you are only given the training cohort. Sometimes this split may be lucky for you, sometimes it may be really tough, but this randomness is not in your heads. What is in your hands though is to submit the model with the best expected (or average) performance in such a scenario. patroklos lets you easily repeat the training part for multiple splits into training and test data and averages in a reasonable manner in the assessment step.</p>
</div>
<div class="section level4">
<h4 id="storing-and-reading-in-models">Storing and reading in models<a class="anchor" aria-label="anchor" href="#storing-and-reading-in-models"></a>
</h4>
<p>Training and assessing so many models takes a lot of time. So as your project evolves over time, you don’t want to fit your models again and again. To this end, patroklos heavily resorts to storing the models and reading them in on demand. Typically you would also “store” the <code>Model</code>, <code>AssScalar</code> and <code>Ass2d</code> objects, either as an .rds file or, more typically, their initialization in an R script. Adding a new model or assessment is then equivalent to adding some lines of code to these R scripts. Typically, you would store your models below <code>models/&lt;data-set name&gt;</code>, patroklos will then store the assessments in the analogous file tree below <code>results/&lt;data-set name&gt;</code>.</p>
</div>
<div class="section level4">
<h4 id="early-integration">Early integration<a class="anchor" aria-label="anchor" href="#early-integration"></a>
</h4>
<p>For a set of diverse features (keep in mind: high-dimensional data and pheno data), it is tempting and simple to do early integration, i.e. providing them to a well known model with a well implemented fitting algorithm. While patroklos assumes you always give the model the high-dimensional omics data, you have the freedom to add features from pheno data, continuous and categorical ones alike. When I started designing this package, I had the <a href="https://github.com/rehbergT/zeroSum" class="external-link"><code>zeroSum</code></a> package delivering the key models that deal with the high-dimensional data in my mind. The <code>zeroSum</code> package provides all the functionality of the <a href="https://github.com/cran/glmnet" class="external-link"><code>glmnet</code></a> with each (generalized linear) model optionally endowed with the zero-sum constraint that causes the model to become scale-invariant. patroklos provides a wrapper around <code><a href="https://rdrr.io/pkg/zeroSum/man/zeroSum.html" class="external-link">zeroSum::zeroSum</a></code> named <code>zeroSumLI</code> to make <code>zeroSum</code> ready for early integration.</p>
<p>Schematically this renders as follows:</p>
<p><img src="reference/figures/README-/early-int.jpeg" alt="drawing" width="400"></p>
</div>
<div class="section level4">
<h4 id="late-integration">Late integration<a class="anchor" aria-label="anchor" href="#late-integration"></a>
</h4>
<p>Early integration seems easy at first glance, but sometimes the fitting algorithm might not be able to handle the data you provide: features on vastly different scales. In such a case, you may want to prefer late integration, i.e. first training an “early” model on the high-dimensional data and then using its (scalar) output together with some more pheno features as the input of another, “late” model.</p>
<p>I’m currently working to include late integration in patroklos and provide fitting algorithms to do this.</p>
<p>Nesting a regularized model whose regularization is tuned in a cross validation into a another model means training the resulting model involves a cross validation. We should continue the cross validation of the early model into the late model. I made <code>zeroSum</code> report enough details on the (many, many) models fit in a cross validation in a fork called <a href="https://github.com/lgessl/zeroSumLI" class="external-link"><code>zeroSumLI</code></a>.</p>
<p>Nesting has no limits as the below picture shows.</p>
<p><img src="reference/figures/README-/late-int.jpeg" alt="drawing" width="400"></p>
</div>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>Make sure you have the <code>devtools</code> package installed, start an R session and then type:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"lgessl/patroklos"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h3>
<p>There are four R6 classes a user of patroklos needs to know about: <code>Data</code>, <code>Model</code>, <code>AssScalar</code> and <code>Ass2d</code>. To understand how they work together over the course of the pipeline and how to use patroklos for your project, you should read their documentation in the same order.</p>
<p>As for preprocessing, you might be interested in</p>
<ul>
<li>[<code>discretize_tbl_columns()</code>] to turn continuous features in your pheno data into binary ones by thresholding them,</li>
<li>[<code>ensure_patients_math()</code>] to ensure expression and pheno data contain exactly the same samples,</li>
<li>[<code><a href="reference/qc_preprocess.html">qc_preprocess()</a></code>] to make sure the readily preprocessed data is in the format patroklos expects, and</li>
<li>[<code><a href="reference/write_data_info.html">write_data_info()</a></code>] to store meta information on the data set in .json file.</li>
</ul>
<p><code><a href="reference/prepend_to_directory.html">prepend_to_directory()</a></code> helps you use <code>Model</code>s you only initialized once to you for multiple data sets.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing patroklos</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Lukas Gessl <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lukas Gessl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
