<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A Data object holds the phenotype and expression data belonging to
a data set. It specifies the names of important features in the columns, reads from
and writes to csv files and takes care of splitting the data into train and test
cohort."><title>An R6 class for the data — Data • patroklos</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An R6 class for the data — Data"><meta property="og:description" content="A Data object holds the phenotype and expression data belonging to
a data set. It specifies the names of important features in the columns, reads from
and writes to csv files and takes care of splitting the data into train and test
cohort."><meta property="og:image" content="https://lgessl.github.io/patroklos/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">patroklos</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>An R6 class for the data</h1>
      
      <div class="d-none name"><code>Data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A Data object holds the phenotype and expression data belonging to
a data set. It specifies the names of important features in the columns, reads from
and writes to csv files and takes care of splitting the data into train and test
cohort.</p>
    </div>


    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>name</code></dt>
<dd><p>How to refer to the data in plots and messages.</p></dd>


<dt><code>directory</code></dt>
<dd><p>Directory where the expression and pheno csv files lie.</p></dd>


<dt><code>train_prop</code></dt>
<dd><p>Proportion of samples in the training cohort.</p></dd>


<dt><code>expr_mat</code></dt>
<dd><p>The expression matrix.</p></dd>


<dt><code>pheno_tbl</code></dt>
<dd><p>The phenotype tibble.</p></dd>


<dt><code>expr_file</code></dt>
<dd><p>Name of the expression csv file inside <code>directory</code>.</p></dd>


<dt><code>pheno_file</code></dt>
<dd><p>Name of the pheno data csv inside <code>directory</code>.</p></dd>


<dt><code>cohort</code></dt>
<dd><p>The cohort of the data, train or test.</p></dd>


<dt><code>patient_id_col</code></dt>
<dd><p>The name of the column in the pheno data that holds
the patient identifiers.</p></dd>


<dt><code>time_to_event_col</code></dt>
<dd><p>The name of the column in the pheno data that holds the
time-to-event values.</p></dd>


<dt><code>event_col</code></dt>
<dd><p>The name of the column in the pheno data that holds
the event status encoded as 1 = occurrence, 0 = censoring.</p></dd>


<dt><code>benchmark_col</code></dt>
<dd><p>The name of the column in the pheno data that holds the
benchmark risk score (like the IPI).</p></dd>


<dt><code>gene_id_col</code></dt>
<dd><p>The name of the column in the expression data that holds
the gene identifiers.</p></dd>


<dt><code>split_col_prefix</code></dt>
<dd><p>Column-name prefix for those columns holding splits into
train and test cohort.</p></dd>


<dt><code>pivot_time_cutoff</code></dt>
<dd><p>Pivotal time cutoff for the analysis and, explicitly,
for splitting the data into the train and test cohort.</p></dd>


<dt><code>imputer</code></dt>
<dd><p>Function handling NAs in the predictor matrix.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-Data-new"><code>Data$new()</code></a></p></li>
<li><p><a href="#method-Data-read"><code>Data$read()</code></a></p></li>
<li><p><a href="#method-Data-prepare"><code>Data$prepare()</code></a></p></li>
<li><p><a href="#method-Data-survival_quantiles"><code>Data$survival_quantiles()</code></a></p></li>
<li><p><a href="#method-Data-qc_preprocess"><code>Data$qc_preprocess()</code></a></p></li>
<li><p><a href="#method-Data-clone"><code>Data$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-Data-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>A Data object specifies the location and format of the expression
and pheno data of a single data set. This enables reading and preparing the data.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/Data.html">Data</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">name</span>,</span>
<span>  <span class="va">directory</span>,</span>
<span>  <span class="va">train_prop</span>,</span>
<span>  <span class="va">pivot_time_cutoff</span>,</span>
<span>  <span class="va">time_to_event_col</span>,</span>
<span>  event_col <span class="op">=</span> <span class="st">"progression"</span>,</span>
<span>  benchmark_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cohort <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  expr_file <span class="op">=</span> <span class="st">"expr.csv"</span>,</span>
<span>  pheno_file <span class="op">=</span> <span class="st">"pheno.csv"</span>,</span>
<span>  patient_id_col <span class="op">=</span> <span class="st">"patient_id"</span>,</span>
<span>  gene_id_col <span class="op">=</span> <span class="st">"gene_id"</span>,</span>
<span>  split_col_prefix <span class="op">=</span> <span class="st">"split_"</span>,</span>
<span>  imputer <span class="op">=</span> <span class="va">mean_impute</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>string. A telling name for the data set (e.g. <code>"Schmitz et al. 2018"</code>).</p></dd>


<dt><code>directory</code></dt>
<dd><p>string. The directory where both expression and pheno csv
files lie.</p></dd>


<dt><code>train_prop</code></dt>
<dd><p>numeric in (0, 1). The proportion of samples to draw for the
training cohort in every splitting run.</p></dd>


<dt><code>pivot_time_cutoff</code></dt>
<dd><p>numeric. Pivotal time cutoff for the analysis and, explicitly,
for splitting the data into the train and test cohort: If a numeric in (0, 1), preserve
the the proportion of individuals below and above <code>time_cutoff</code> in both cohorts. Default
is <code>NULL</code>, i.e. no further constraints on splitting.</p></dd>


<dt><code>time_to_event_col</code></dt>
<dd><p>string. The name of the column in the pheno data that holds the
time-to-event values.</p></dd>


<dt><code>event_col</code></dt>
<dd><p>string. The name of the column in the pheno data that holds
the event status encoded as 1 = occurrence, 0 = censoring.</p></dd>


<dt><code>benchmark_col</code></dt>
<dd><p>string or <code>NULL</code>. The name of the column in the pheno data that
holds the benchmark risk score (like the IPI).</p></dd>


<dt><code>cohort</code></dt>
<dd><p>string in <code>c("train", "test")</code> or <code>NULL</code>. The cohort, train or test, to
prepare the data for. If NULL, the default, some functions will set it themselves
(e.g. <code><a href="training_camp.html">training_camp()</a></code> to <code>"train"</code>, <code>assess_2d()</code> to <code>"test"</code>), others will
throw an error.</p></dd>


<dt><code>expr_file</code></dt>
<dd><p>string. The name of the expression csv file inside <code>directory</code>.
Default is <code>"expr.csv"</code>. See details for the expected format.</p></dd>


<dt><code>pheno_file</code></dt>
<dd><p>string. The name of the pheno data csv inside <code>directory</code>.
Default is <code>"pheno.csv"</code>. See details for the expected format.</p></dd>


<dt><code>patient_id_col</code></dt>
<dd><p>string. The name of the column in the pheno data that holds
the patient identifiers.</p></dd>


<dt><code>gene_id_col</code></dt>
<dd><p>string. The name of the column in the expression data that holds
the gene identifiers.</p></dd>


<dt><code>split_col_prefix</code></dt>
<dd><p>string. Column-name prefix for those columns holding splits into
train and test cohort. Some of these columns may be present in the pheno data already,
others will be added during the training process if required. Default is <code>"split_"</code>,
i.e., split columns are named <code>"split_1"</code>, <code>"split_2"</code>, etc.</p></dd>


<dt><code>imputer</code></dt>
<dd><p>function or NULL. Function handling NAs in the predictor matrix.
It takes a single argument <code>x</code>, the predictor matrix, a numeric with categorical
variables dichotomized to binary dummy variables, and returns a matrix of the
same shape with non-NAs left untouched. Default is <code><a href="mean_impute.html">mean_impute()</a></code>.
NULL means no imputation (or applying the identity function on <code>x</code>).</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h4>
<p>The pheno csv file holds the samples as rows (with <em>unique</em> sample ids in the
first (character) column called <code>patient_id_col</code>), the variables as columns.</p>
<p>The expression csv file holds the genes as rows (with <em>unique</em> gene ids in the first
(character) column called <code>gene_id_col</code>), the samples as columns.</p>
<p>While the computational representation of both expression and pheno data will
change over the course of the pipeline, a Data object will hold timeless
information on the data.</p>
</div>

<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>A Data object.</p>
</div>

</div><p></p><hr><a id="method-Data-read"></a><div class="section">
<h3 id="method-read-">Method <code>read()</code><a class="anchor" aria-label="anchor" href="#method-read-"></a></h3>
<p>Read expression data into the matrix <code>expr_mat</code> and pheno
data into the tibble <code>pheno_tbl</code>. Both will hold patients as rows.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Data</span><span class="op">$</span><span class="fu">read</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Data-prepare"></a><div class="section">
<h3 id="method-prepare-">Method <code>prepare()</code><a class="anchor" aria-label="anchor" href="#method-prepare-"></a></h3>
<p>Prepare the read-in data for a model.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Data</span><span class="op">$</span><span class="fu">prepare</span><span class="op">(</span><span class="va">model</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>model</code></dt>
<dd><p>A Model object.</p></dd>


<dt><code>quiet</code></dt>
<dd><p>logical. If TRUE, suppress messages.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-1">Details<a class="anchor" aria-label="anchor" href="#details-1"></a></h4>
<p>You need to set the cohort before calling this method.</p>
</div>


</div><p></p><hr><a id="method-Data-survival_quantiles"></a><div class="section">
<h3 id="method-survival-quantiles-">Method <code>survival_quantiles()</code><a class="anchor" aria-label="anchor" href="#method-survival-quantiles-"></a></h3>
<p>Calculate the quantiles of the survival times.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Data</span><span class="op">$</span><span class="fu">survival_quantiles</span><span class="op">(</span>round_digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>round_digits</code></dt>
<dd><p>integer. Round the numbers in the returned tibble
to this number of digits after the point.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-2">Details<a class="anchor" aria-label="anchor" href="#details-2"></a></h4>
<p>We take censoring into account.</p>
</div>

<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>A tibble with two columns. For each quantile q in the first
column, the time-to-event value in the second column.</p>
</div>

</div><p></p><hr><a id="method-Data-qc_preprocess"></a><div class="section">
<h3 id="method-qc-preprocess-">Method <code>qc_preprocess()</code><a class="anchor" aria-label="anchor" href="#method-qc-preprocess-"></a></h3>
<p>Quality control at the end of preprocessing</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Data</span><span class="op">$</span><span class="fu">qc_preprocess</span><span class="op">(</span><span class="va">expr_tbl</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>expr_tbl</code></dt>
<dd><p>A tibble with the expression data, the product of
reading in an expression csv file as described in the details of
the initialize() method.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-3">Details<a class="anchor" aria-label="anchor" href="#details-3"></a></h4>
<p>Check if the expression and pheno tibble are consistent
with the other attributes of the Data object. You typically call this
method at the end of preprocessing, and the read() method calls it.</p>
</div>


</div><p></p><hr><a id="method-Data-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Data</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lukas Gessl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

